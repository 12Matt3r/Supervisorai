<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniMax Supervisor Interface</title>
    <style>
        body { font-family: sans-serif; margin: 2em; background-color: #f4f4f9; color: #333; }
        .container { max-width: 600px; margin: auto; background: white; padding: 2em; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #4a4a4a; }
        .form-group { margin-bottom: 1.5em; }
        label { display: block; margin-bottom: 0.5em; font-weight: bold; }
        input[type="range"] { width: 100%; }
        input[type="number"] { width: 100px; padding: 0.5em; border-radius: 4px; border: 1px solid #ccc; }
        button { display: block; width: 100%; padding: 1em; background-color: #007bff; color: white; border: none; border-radius: 4px; font-size: 1em; cursor: pointer; transition: background-color 0.3s; }
        button:hover { background-color: #0056b3; }
        #result { margin-top: 2em; padding: 1em; background-color: #e9ecef; border: 1px solid #ced4da; border-radius: 4px; text-align: center; font-size: 1.2em; font-weight: bold; min-height: 50px; }
        .slider-value { font-weight: normal; color: #007bff; margin-left: 1em; }
    </style>
</head>
<body>

    <div class="container">
        <h1>MiniMax Supervisor Decision</h1>

        <div class="form-group">
            <label for="quality_score">Quality Score: <span id="quality_score_value" class="slider-value">0.8</span></label>
            <input type="range" id="quality_score" min="0" max="1" step="0.01" value="0.8">
        </div>

        <div class="form-group">
            <label for="resource_usage">Resource Usage: <span id="resource_usage_value" class="slider-value">0.5</span></label>
            <input type="range" id="resource_usage" min="0" max="1" step="0.01" value="0.5">
        </div>

        <div class="form-group">
            <label for="task_progress">Task Progress: <span id="task_progress_value" class="slider-value">0.6</span></label>
            <input type="range" id="task_progress" min="0" max="1" step="0.01" value="0.6">
        </div>

        <div class="form-group">
            <label for="error_count">Error Count:</label>
            <input type="number" id="error_count" min="0" max="10" value="1">
        </div>

        <button id="get_decision_btn">Get Decision</button>

        <div id="result">...</div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const qualityScoreSlider = document.getElementById('quality_score');
            const resourceUsageSlider = document.getElementById('resource_usage');
            const taskProgressSlider = document.getElementById('task_progress');
            const errorCountInput = document.getElementById('error_count');
            const getDecisionBtn = document.getElementById('get_decision_btn');
            const resultDiv = document.getElementById('result');

            // Update slider value displays
            qualityScoreSlider.oninput = () => document.getElementById('quality_score_value').textContent = qualityScoreSlider.value;
            resourceUsageSlider.oninput = () => document.getElementById('resource_usage_value').textContent = resourceUsageSlider.value;
            taskProgressSlider.oninput = () => document.getElementById('task_progress_value').textContent = taskProgressSlider.value;

            getDecisionBtn.addEventListener('click', () => {
                resultDiv.textContent = 'Connecting...';
                const socket = new WebSocket('ws://localhost:8765');

                socket.onopen = () => {
                    resultDiv.textContent = 'Getting decision...';
                    const payload = {
                        tool: 'get_minimax_decision',
                        args: {
                            quality_score: parseFloat(qualityScoreSlider.value),
                            error_count: parseInt(errorCountInput.value, 10),
                            resource_usage: parseFloat(resourceUsageSlider.value),
                            task_progress: parseFloat(taskProgressSlider.value)
                        }
                    };
                    socket.send(JSON.stringify(payload));
                };

                socket.onmessage = (event) => {
                    try {
                        const response = JSON.parse(event.data);
                        if (response.success) {
                            resultDiv.textContent = `Decision: ${response.decision}`;
                        } else {
                            resultDiv.textContent = `Error: ${response.error}`;
                        }
                    } catch (e) {
                        resultDiv.textContent = 'Error: Could not parse server response.';
                    }
                    socket.close();
                };

                socket.onerror = (error) => {
                    resultDiv.textContent = 'Error: Could not connect to the supervisor server.';
                    console.error('WebSocket Error:', error);
                };

                socket.onclose = () => {
                    console.log('WebSocket connection closed.');
                };
            });
        });
    </script>

</body>
</html>
